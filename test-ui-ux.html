<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ç¤¾ç•œè§£æ”¾å¡ - UI/UX ç¶œåˆæ¸¬è©¦å¥—ä»¶</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <style>
      .test-pass {
        color: #10b981;
      }
      .test-fail {
        color: #ef4444;
      }
      .test-pending {
        color: #f59e0b;
      }
      .test-suite {
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        margin: 16px 0;
        padding: 16px;
      }
      .test-result {
        padding: 8px;
        margin: 4px 0;
        border-radius: 4px;
        font-family: monospace;
      }
      .performance-chart {
        width: 100%;
        height: 200px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
      }
      .responsive-test {
        border: 2px solid #3b82f6;
        border-radius: 8px;
        margin: 8px;
        padding: 12px;
      }
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
      }
      .modal-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        border-radius: 12px;
        padding: 24px;
        max-width: 90vw;
        max-height: 90vh;
        overflow-y: auto;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen p-4">
    <!-- æ¸¬è©¦æ§åˆ¶å° -->
    <div class="max-w-6xl mx-auto">
      <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
        <h1 class="text-3xl font-bold text-gray-800 mb-4">
          <i class="fas fa-clipboard-check text-blue-600 mr-3"></i>
          ç¤¾ç•œè§£æ”¾å¡ - UI/UX ç¶œåˆæ¸¬è©¦å¥—ä»¶
        </h1>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
          <button
            onclick="runFunctionalTests()"
            class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
          >
            <i class="fas fa-cogs mr-2"></i>åŠŸèƒ½æ¸¬è©¦
          </button>
          <button
            onclick="runResponsiveTests()"
            class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors"
          >
            <i class="fas fa-mobile-alt mr-2"></i>éŸ¿æ‡‰å¼æ¸¬è©¦
          </button>
          <button
            onclick="runPerformanceTests()"
            class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors"
          >
            <i class="fas fa-tachometer-alt mr-2"></i>æ•ˆèƒ½æ¸¬è©¦
          </button>
          <button
            onclick="runAccessibilityTests()"
            class="bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors"
          >
            <i class="fas fa-universal-access mr-2"></i>ç„¡éšœç¤™æ€§æ¸¬è©¦
          </button>
        </div>

        <div class="flex justify-between items-center mb-4">
          <div class="text-sm text-gray-600">
            æ¸¬è©¦é–‹å§‹æ™‚é–“: <span id="testStartTime">-</span>
          </div>
          <div class="text-sm text-gray-600">
            ç¸½é€²åº¦: <span id="overallProgress">0/0</span>
          </div>
        </div>

        <div class="w-full bg-gray-200 rounded-full h-2">
          <div
            id="progressBar"
            class="bg-blue-600 h-2 rounded-full"
            style="width: 0%"
          ></div>
        </div>
      </div>

      <!-- æ¸¬è©¦çµæœå€åŸŸ -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- åŠŸèƒ½æ¸¬è©¦çµæœ -->
        <div class="test-suite bg-white rounded-lg shadow">
          <h2 class="text-xl font-semibold mb-4 text-gray-800">
            <i class="fas fa-cogs text-blue-600 mr-2"></i>åŠŸèƒ½æ¸¬è©¦çµæœ
          </h2>
          <div id="functionalTestResults" class="space-y-2">
            <div class="text-gray-500 text-center py-8">
              é»æ“Šã€ŒåŠŸèƒ½æ¸¬è©¦ã€é–‹å§‹æ¸¬è©¦
            </div>
          </div>
        </div>

        <!-- éŸ¿æ‡‰å¼æ¸¬è©¦çµæœ -->
        <div class="test-suite bg-white rounded-lg shadow">
          <h2 class="text-xl font-semibold mb-4 text-gray-800">
            <i class="fas fa-mobile-alt text-green-600 mr-2"></i>éŸ¿æ‡‰å¼æ¸¬è©¦çµæœ
          </h2>
          <div id="responsiveTestResults" class="space-y-2">
            <div class="text-gray-500 text-center py-8">
              é»æ“Šã€ŒéŸ¿æ‡‰å¼æ¸¬è©¦ã€é–‹å§‹æ¸¬è©¦
            </div>
          </div>
        </div>

        <!-- æ•ˆèƒ½æ¸¬è©¦çµæœ -->
        <div class="test-suite bg-white rounded-lg shadow">
          <h2 class="text-xl font-semibold mb-4 text-gray-800">
            <i class="fas fa-tachometer-alt text-purple-600 mr-2"></i
            >æ•ˆèƒ½æ¸¬è©¦çµæœ
          </h2>
          <div id="performanceTestResults" class="space-y-2">
            <div class="text-gray-500 text-center py-8">
              é»æ“Šã€Œæ•ˆèƒ½æ¸¬è©¦ã€é–‹å§‹æ¸¬è©¦
            </div>
          </div>
          <canvas
            id="performanceChart"
            class="performance-chart mt-4"
            style="display: none"
          ></canvas>
        </div>

        <!-- ç„¡éšœç¤™æ€§æ¸¬è©¦çµæœ -->
        <div class="test-suite bg-white rounded-lg shadow">
          <h2 class="text-xl font-semibold mb-4 text-gray-800">
            <i class="fas fa-universal-access text-orange-600 mr-2"></i
            >ç„¡éšœç¤™æ€§æ¸¬è©¦çµæœ
          </h2>
          <div id="accessibilityTestResults" class="space-y-2">
            <div class="text-gray-500 text-center py-8">
              é»æ“Šã€Œç„¡éšœç¤™æ€§æ¸¬è©¦ã€é–‹å§‹æ¸¬è©¦
            </div>
          </div>
        </div>
      </div>

      <!-- æ¸¬è©¦æ‘˜è¦ -->
      <div class="bg-white rounded-lg shadow-lg p-6 mt-6">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">
          <i class="fas fa-chart-bar text-indigo-600 mr-2"></i>æ¸¬è©¦æ‘˜è¦
        </h2>
        <div id="testSummary" class="grid grid-cols-2 md:grid-cols-4 gap-4">
          <div class="text-center">
            <div class="text-2xl font-bold text-blue-600" id="functionalCount">
              0
            </div>
            <div class="text-sm text-gray-600">åŠŸèƒ½æ¸¬è©¦</div>
          </div>
          <div class="text-center">
            <div class="text-2xl font-bold text-green-600" id="responsiveCount">
              0
            </div>
            <div class="text-sm text-gray-600">éŸ¿æ‡‰å¼æ¸¬è©¦</div>
          </div>
          <div class="text-center">
            <div
              class="text-2xl font-bold text-purple-600"
              id="performanceCount"
            >
              0
            </div>
            <div class="text-sm text-gray-600">æ•ˆèƒ½æ¸¬è©¦</div>
          </div>
          <div class="text-center">
            <div
              class="text-2xl font-bold text-orange-600"
              id="accessibilityCount"
            >
              0
            </div>
            <div class="text-sm text-gray-600">ç„¡éšœç¤™æ€§æ¸¬è©¦</div>
          </div>
        </div>
      </div>

      <!-- æ‡‰ç”¨ç¨‹å¼é è¦½æ¡†æ¶ -->
      <div class="bg-white rounded-lg shadow-lg p-6 mt-6">
        <h2 class="text-xl font-semibold mb-4 text-gray-800">
          <i class="fas fa-eye text-teal-600 mr-2"></i>æ‡‰ç”¨ç¨‹å¼é è¦½èˆ‡äº’å‹•æ¸¬è©¦
        </h2>
        <div class="border rounded-lg overflow-hidden">
          <iframe
            id="appPreview"
            src="index.html"
            class="w-full h-96 border-0"
          ></iframe>
        </div>
        <div class="mt-4 flex flex-wrap gap-2">
          <button
            onclick="setPreviewSize('mobile')"
            class="px-3 py-1 bg-blue-100 text-blue-800 rounded-md text-sm"
          >
            ğŸ“± æ‰‹æ©Ÿ (375px)
          </button>
          <button
            onclick="setPreviewSize('tablet')"
            class="px-3 py-1 bg-green-100 text-green-800 rounded-md text-sm"
          >
            ğŸ“± å¹³æ¿ (768px)
          </button>
          <button
            onclick="setPreviewSize('desktop')"
            class="px-3 py-1 bg-purple-100 text-purple-800 rounded-md text-sm"
          >
            ğŸ’» æ¡Œé¢ (1024px)
          </button>
          <button
            onclick="setPreviewSize('full')"
            class="px-3 py-1 bg-gray-100 text-gray-800 rounded-md text-sm"
          >
            ğŸ–¥ï¸ å…¨è¢å¹•
          </button>
        </div>
      </div>
    </div>

    <!-- æ¸¬è©¦è©³æƒ…æ¨¡æ…‹çª— -->
    <div id="testDetailModal" class="modal-overlay hidden">
      <div class="modal-content">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-semibold">æ¸¬è©¦è©³æƒ…</h3>
          <button
            onclick="closeTestDetail()"
            class="text-gray-400 hover:text-gray-600"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div id="testDetailContent" class="space-y-4"></div>
      </div>
    </div>

    <script>
      // å…¨åŸŸè®Šæ•¸
      let testResults = {
        functional: [],
        responsive: [],
        performance: [],
        accessibility: [],
      };
      let totalTests = 0;
      let completedTests = 0;

      // åˆå§‹åŒ–
      document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("testStartTime").textContent =
          new Date().toLocaleString("zh-TW");
      });

      // å·¥å…·å‡½æ•¸
      function addTestResult(
        category,
        testName,
        status,
        details = "",
        duration = 0
      ) {
        const result = {
          name: testName,
          status: status, // 'pass', 'fail', 'pending'
          details: details,
          duration: duration,
          timestamp: new Date().toISOString(),
        };

        testResults[category].push(result);
        updateTestDisplay(category);
        updateProgress();
      }

      function updateTestDisplay(category) {
        const container = document.getElementById(`${category}TestResults`);
        const results = testResults[category];

        container.innerHTML = results
          .map((result) => {
            const statusClass =
              result.status === "pass"
                ? "test-pass bg-green-50"
                : result.status === "fail"
                ? "test-fail bg-red-50"
                : "test-pending bg-yellow-50";
            const icon =
              result.status === "pass"
                ? "fas fa-check-circle"
                : result.status === "fail"
                ? "fas fa-times-circle"
                : "fas fa-clock";

            return `
                    <div class="test-result ${statusClass}">
                        <div class="flex justify-between items-start">
                            <div class="flex items-center">
                                <i class="${icon} mr-2"></i>
                                <span class="font-medium">${result.name}</span>
                            </div>
                            <span class="text-xs text-gray-500">${
                              result.duration
                            }ms</span>
                        </div>
                        ${
                          result.details
                            ? `<div class="text-sm mt-1 text-gray-600">${result.details}</div>`
                            : ""
                        }
                    </div>
                `;
          })
          .join("");

        // æ›´æ–°è¨ˆæ•¸å™¨
        const passCount = results.filter((r) => r.status === "pass").length;
        const totalCount = results.length;
        document.getElementById(
          `${category}Count`
        ).textContent = `${passCount}/${totalCount}`;
      }

      function updateProgress() {
        const progress =
          totalTests > 0 ? (completedTests / totalTests) * 100 : 0;
        document.getElementById("progressBar").style.width = `${progress}%`;
        document.getElementById(
          "overallProgress"
        ).textContent = `${completedTests}/${totalTests}`;
      }

      // åŠŸèƒ½æ¸¬è©¦
      async function runFunctionalTests() {
        const startTime = performance.now();
        testResults.functional = [];
        totalTests += 8;

        addTestResult("functional", "æª¢æŸ¥ä¸»æ‡‰ç”¨ç¨‹å¼è¼‰å…¥", "pending");

        try {
          // æ¸¬è©¦ 1: æª¢æŸ¥æ‡‰ç”¨ç¨‹å¼åŸºæœ¬è¼‰å…¥
          await new Promise((resolve) => setTimeout(resolve, 100));
          const appFrame = document.getElementById("appPreview");
          if (appFrame.src.includes("index.html")) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ä¸»æ‡‰ç”¨ç¨‹å¼è¼‰å…¥",
              "pass",
              "æ‡‰ç”¨ç¨‹å¼æˆåŠŸè¼‰å…¥",
              performance.now() - startTime
            );
          } else {
            addTestResult(
              "functional",
              "æª¢æŸ¥ä¸»æ‡‰ç”¨ç¨‹å¼è¼‰å…¥",
              "fail",
              "æ‡‰ç”¨ç¨‹å¼è¼‰å…¥å¤±æ•—"
            );
          }
          completedTests++;

          // æ¸¬è©¦ 2: æª¢æŸ¥ LocalStorage åŠŸèƒ½
          addTestResult("functional", "æª¢æŸ¥ LocalStorage æ”¯æ´", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          try {
            localStorage.setItem("test", "value");
            const value = localStorage.getItem("test");
            localStorage.removeItem("test");
            if (value === "value") {
              addTestResult(
                "functional",
                "æª¢æŸ¥ LocalStorage æ”¯æ´",
                "pass",
                "LocalStorage åŠŸèƒ½æ­£å¸¸"
              );
            } else {
              addTestResult(
                "functional",
                "æª¢æŸ¥ LocalStorage æ”¯æ´",
                "fail",
                "LocalStorage è®€å¯«ç•°å¸¸"
              );
            }
          } catch (e) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ LocalStorage æ”¯æ´",
              "fail",
              `LocalStorage éŒ¯èª¤: ${e.message}`
            );
          }
          completedTests++;

          // æ¸¬è©¦ 3: æª¢æŸ¥ Service Worker æ”¯æ´
          addTestResult("functional", "æª¢æŸ¥ Service Worker æ”¯æ´", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          if ("serviceWorker" in navigator) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ Service Worker æ”¯æ´",
              "pass",
              "ç€è¦½å™¨æ”¯æ´ Service Worker"
            );
          } else {
            addTestResult(
              "functional",
              "æª¢æŸ¥ Service Worker æ”¯æ´",
              "fail",
              "ç€è¦½å™¨ä¸æ”¯æ´ Service Worker"
            );
          }
          completedTests++;

          // æ¸¬è©¦ 4: æª¢æŸ¥ PWA Manifest
          addTestResult("functional", "æª¢æŸ¥ PWA Manifest", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          try {
            const response = await fetch("manifest.json");
            if (response.ok) {
              const manifest = await response.json();
              if (manifest.name && manifest.icons) {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ PWA Manifest",
                  "pass",
                  `æ‡‰ç”¨åç¨±: ${manifest.name}`
                );
              } else {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ PWA Manifest",
                  "fail",
                  "Manifest æ ¼å¼ä¸å®Œæ•´"
                );
              }
            } else {
              addTestResult(
                "functional",
                "æª¢æŸ¥ PWA Manifest",
                "fail",
                "Manifest æª”æ¡ˆç„¡æ³•è¼‰å…¥"
              );
            }
          } catch (e) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ PWA Manifest",
              "fail",
              `Manifest éŒ¯èª¤: ${e.message}`
            );
          }
          completedTests++;

          // æ¸¬è©¦ 5: æª¢æŸ¥åœ–ç‰‡è³‡æº
          addTestResult("functional", "æª¢æŸ¥åœ–ç‰‡è³‡æºè¼‰å…¥", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          const imageTests = ["icon-192.png", "icon-512.png", "og-image.png"];
          let imageLoadCount = 0;

          for (const imgSrc of imageTests) {
            try {
              const response = await fetch(imgSrc);
              if (response.ok) imageLoadCount++;
            } catch (e) {
              // åœ–ç‰‡è¼‰å…¥å¤±æ•—
            }
          }

          if (imageLoadCount === imageTests.length) {
            addTestResult(
              "functional",
              "æª¢æŸ¥åœ–ç‰‡è³‡æºè¼‰å…¥",
              "pass",
              `${imageLoadCount}/${imageTests.length} åœ–ç‰‡è¼‰å…¥æˆåŠŸ`
            );
          } else {
            addTestResult(
              "functional",
              "æª¢æŸ¥åœ–ç‰‡è³‡æºè¼‰å…¥",
              "fail",
              `åªæœ‰ ${imageLoadCount}/${imageTests.length} åœ–ç‰‡è¼‰å…¥æˆåŠŸ`
            );
          }
          completedTests++;

          // æ¸¬è©¦ 6: æª¢æŸ¥ CSS è¼‰å…¥
          addTestResult("functional", "æª¢æŸ¥ CSS æ¨£å¼è¼‰å…¥", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          try {
            const response = await fetch("styles.css");
            if (response.ok) {
              const cssText = await response.text();
              if (cssText.length > 100) {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ CSS æ¨£å¼è¼‰å…¥",
                  "pass",
                  `CSS æª”æ¡ˆå¤§å°: ${Math.round(cssText.length / 1024)}KB`
                );
              } else {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ CSS æ¨£å¼è¼‰å…¥",
                  "fail",
                  "CSS æª”æ¡ˆéå°æˆ–ç©ºç™½"
                );
              }
            } else {
              addTestResult(
                "functional",
                "æª¢æŸ¥ CSS æ¨£å¼è¼‰å…¥",
                "fail",
                "CSS æª”æ¡ˆç„¡æ³•è¼‰å…¥"
              );
            }
          } catch (e) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ CSS æ¨£å¼è¼‰å…¥",
              "fail",
              `CSS è¼‰å…¥éŒ¯èª¤: ${e.message}`
            );
          }
          completedTests++;

          // æ¸¬è©¦ 7: æª¢æŸ¥ JavaScript è¼‰å…¥
          addTestResult("functional", "æª¢æŸ¥ JavaScript è¼‰å…¥", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          try {
            const response = await fetch("script.js");
            if (response.ok) {
              const jsText = await response.text();
              if (jsText.length > 1000) {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ JavaScript è¼‰å…¥",
                  "pass",
                  `JS æª”æ¡ˆå¤§å°: ${Math.round(jsText.length / 1024)}KB`
                );
              } else {
                addTestResult(
                  "functional",
                  "æª¢æŸ¥ JavaScript è¼‰å…¥",
                  "fail",
                  "JS æª”æ¡ˆéå°æˆ–ç©ºç™½"
                );
              }
            } else {
              addTestResult(
                "functional",
                "æª¢æŸ¥ JavaScript è¼‰å…¥",
                "fail",
                "JS æª”æ¡ˆç„¡æ³•è¼‰å…¥"
              );
            }
          } catch (e) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ JavaScript è¼‰å…¥",
              "fail",
              `JS è¼‰å…¥éŒ¯èª¤: ${e.message}`
            );
          }
          completedTests++;

          // æ¸¬è©¦ 8: æª¢æŸ¥ SEO æ–‡ä»¶
          addTestResult("functional", "æª¢æŸ¥ SEO ç›¸é—œæ–‡ä»¶", "pending");
          await new Promise((resolve) => setTimeout(resolve, 50));
          try {
            const seoFiles = ["sitemap.xml", "robots.txt", "llms.txt"];
            let seoLoadCount = 0;

            for (const file of seoFiles) {
              try {
                const response = await fetch(file);
                if (response.ok) seoLoadCount++;
              } catch (e) {
                // SEO æª”æ¡ˆè¼‰å…¥å¤±æ•—
              }
            }

            if (seoLoadCount === seoFiles.length) {
              addTestResult(
                "functional",
                "æª¢æŸ¥ SEO ç›¸é—œæ–‡ä»¶",
                "pass",
                `${seoLoadCount}/${seoFiles.length} SEO æª”æ¡ˆè¼‰å…¥æˆåŠŸ`
              );
            } else {
              addTestResult(
                "functional",
                "æª¢æŸ¥ SEO ç›¸é—œæ–‡ä»¶",
                "fail",
                `åªæœ‰ ${seoLoadCount}/${seoFiles.length} SEO æª”æ¡ˆè¼‰å…¥æˆåŠŸ`
              );
            }
          } catch (e) {
            addTestResult(
              "functional",
              "æª¢æŸ¥ SEO ç›¸é—œæ–‡ä»¶",
              "fail",
              `SEO æª”æ¡ˆæª¢æŸ¥éŒ¯èª¤: ${e.message}`
            );
          }
          completedTests++;
        } catch (error) {
          addTestResult(
            "functional",
            "åŠŸèƒ½æ¸¬è©¦åŸ·è¡Œ",
            "fail",
            `æ¸¬è©¦åŸ·è¡ŒéŒ¯èª¤: ${error.message}`
          );
          completedTests++;
        }
      }

      // éŸ¿æ‡‰å¼æ¸¬è©¦
      async function runResponsiveTests() {
        testResults.responsive = [];
        totalTests += 6;

        const breakpoints = [
          { name: "æ‰‹æ©Ÿç«¯ (375px)", width: 375 },
          { name: "å¤§æ‰‹æ©Ÿ (425px)", width: 425 },
          { name: "å¹³æ¿ç«¯ (768px)", width: 768 },
          { name: "å°ç­†é›» (1024px)", width: 1024 },
          { name: "æ¡Œé¢ç«¯ (1440px)", width: 1440 },
          { name: "å¤§è¢å¹• (1920px)", width: 1920 },
        ];

        for (const breakpoint of breakpoints) {
          addTestResult("responsive", `æ¸¬è©¦ ${breakpoint.name}`, "pending");
          await new Promise((resolve) => setTimeout(resolve, 100));

          try {
            // è¨­å®šé è¦½æ¡†æ¶å°ºå¯¸
            const preview = document.getElementById("appPreview");
            preview.style.width = `${breakpoint.width}px`;

            // ç­‰å¾…é‡æ–°æ¸²æŸ“
            await new Promise((resolve) => setTimeout(resolve, 200));

            // æª¢æŸ¥æ˜¯å¦é©åˆè©²å°ºå¯¸
            const isResponsive = preview.offsetWidth <= breakpoint.width + 10; // å…è¨±10pxèª¤å·®

            if (isResponsive) {
              addTestResult(
                "responsive",
                `æ¸¬è©¦ ${breakpoint.name}`,
                "pass",
                `æ­£ç¢ºé©æ‡‰ ${breakpoint.width}px å¯¬åº¦`
              );
            } else {
              addTestResult(
                "responsive",
                `æ¸¬è©¦ ${breakpoint.name}`,
                "fail",
                `æœªæ­£ç¢ºé©æ‡‰ ${breakpoint.width}px å¯¬åº¦`
              );
            }
          } catch (error) {
            addTestResult(
              "responsive",
              `æ¸¬è©¦ ${breakpoint.name}`,
              "fail",
              `æ¸¬è©¦éŒ¯èª¤: ${error.message}`
            );
          }
          completedTests++;
        }

        // æ¢å¾©é è¦½æ¡†æ¶åŸå§‹å°ºå¯¸
        document.getElementById("appPreview").style.width = "100%";
      }

      // æ•ˆèƒ½æ¸¬è©¦
      async function runPerformanceTests() {
        testResults.performance = [];
        totalTests += 5;

        // æ¸¬è©¦ 1: é é¢è¼‰å…¥æ™‚é–“
        addTestResult("performance", "é é¢è¼‰å…¥æ™‚é–“æ¸¬è©¦", "pending");
        const loadStart = performance.now();

        try {
          await new Promise((resolve) => setTimeout(resolve, 100));
          const loadTime = performance.now() - loadStart;

          if (loadTime < 1000) {
            addTestResult(
              "performance",
              "é é¢è¼‰å…¥æ™‚é–“æ¸¬è©¦",
              "pass",
              `è¼‰å…¥æ™‚é–“: ${loadTime.toFixed(2)}ms`
            );
          } else if (loadTime < 3000) {
            addTestResult(
              "performance",
              "é é¢è¼‰å…¥æ™‚é–“æ¸¬è©¦",
              "pass",
              `è¼‰å…¥æ™‚é–“: ${loadTime.toFixed(2)}ms (ç¨æ…¢)`
            );
          } else {
            addTestResult(
              "performance",
              "é é¢è¼‰å…¥æ™‚é–“æ¸¬è©¦",
              "fail",
              `è¼‰å…¥æ™‚é–“éé•·: ${loadTime.toFixed(2)}ms`
            );
          }
        } catch (error) {
          addTestResult(
            "performance",
            "é é¢è¼‰å…¥æ™‚é–“æ¸¬è©¦",
            "fail",
            `æ¸¬è©¦éŒ¯èª¤: ${error.message}`
          );
        }
        completedTests++;

        // æ¸¬è©¦ 2: è¨˜æ†¶é«”ä½¿ç”¨é‡
        addTestResult("performance", "è¨˜æ†¶é«”ä½¿ç”¨é‡æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        if ("memory" in performance) {
          const memory = performance.memory;
          const usedMB = Math.round(memory.usedJSHeapSize / 1024 / 1024);

          if (usedMB < 50) {
            addTestResult(
              "performance",
              "è¨˜æ†¶é«”ä½¿ç”¨é‡æª¢æŸ¥",
              "pass",
              `è¨˜æ†¶é«”ä½¿ç”¨: ${usedMB}MB`
            );
          } else if (usedMB < 100) {
            addTestResult(
              "performance",
              "è¨˜æ†¶é«”ä½¿ç”¨é‡æª¢æŸ¥",
              "pass",
              `è¨˜æ†¶é«”ä½¿ç”¨: ${usedMB}MB (ä¸­ç­‰)`
            );
          } else {
            addTestResult(
              "performance",
              "è¨˜æ†¶é«”ä½¿ç”¨é‡æª¢æŸ¥",
              "fail",
              `è¨˜æ†¶é«”ä½¿ç”¨éé«˜: ${usedMB}MB`
            );
          }
        } else {
          addTestResult(
            "performance",
            "è¨˜æ†¶é«”ä½¿ç”¨é‡æª¢æŸ¥",
            "fail",
            "ç€è¦½å™¨ä¸æ”¯æ´è¨˜æ†¶é«” API"
          );
        }
        completedTests++;

        // æ¸¬è©¦ 3: DOM ç¯€é»æ•¸é‡
        addTestResult("performance", "DOM ç¯€é»æ•¸é‡æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const nodeCount = document.querySelectorAll("*").length;
        if (nodeCount < 1000) {
          addTestResult(
            "performance",
            "DOM ç¯€é»æ•¸é‡æª¢æŸ¥",
            "pass",
            `DOM ç¯€é»: ${nodeCount}`
          );
        } else if (nodeCount < 2000) {
          addTestResult(
            "performance",
            "DOM ç¯€é»æ•¸é‡æª¢æŸ¥",
            "pass",
            `DOM ç¯€é»: ${nodeCount} (ä¸­ç­‰)`
          );
        } else {
          addTestResult(
            "performance",
            "DOM ç¯€é»æ•¸é‡æª¢æŸ¥",
            "fail",
            `DOM ç¯€é»éå¤š: ${nodeCount}`
          );
        }
        completedTests++;

        // æ¸¬è©¦ 4: è³‡æºè¼‰å…¥æ™‚é–“
        addTestResult("performance", "è³‡æºè¼‰å…¥æ™‚é–“æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        if ("getEntriesByType" in performance) {
          const resources = performance.getEntriesByType("resource");
          const slowResources = resources.filter((r) => r.duration > 1000);

          if (slowResources.length === 0) {
            addTestResult(
              "performance",
              "è³‡æºè¼‰å…¥æ™‚é–“æª¢æŸ¥",
              "pass",
              `${resources.length} å€‹è³‡æºè¼‰å…¥æ­£å¸¸`
            );
          } else {
            addTestResult(
              "performance",
              "è³‡æºè¼‰å…¥æ™‚é–“æª¢æŸ¥",
              "fail",
              `${slowResources.length} å€‹è³‡æºè¼‰å…¥éæ…¢`
            );
          }
        } else {
          addTestResult(
            "performance",
            "è³‡æºè¼‰å…¥æ™‚é–“æª¢æŸ¥",
            "fail",
            "ç€è¦½å™¨ä¸æ”¯æ´ Performance API"
          );
        }
        completedTests++;

        // æ¸¬è©¦ 5: FPS æ¸¬è©¦ (ç°¡åŒ–ç‰ˆ)
        addTestResult("performance", "FPS æµæš¢åº¦æ¸¬è©¦", "pending");

        let frameCount = 0;
        const fpsStart = performance.now();

        function countFrames() {
          frameCount++;
          if (performance.now() - fpsStart < 1000) {
            requestAnimationFrame(countFrames);
          } else {
            const fps = frameCount;
            if (fps >= 50) {
              addTestResult(
                "performance",
                "FPS æµæš¢åº¦æ¸¬è©¦",
                "pass",
                `FPS: ${fps}`
              );
            } else if (fps >= 30) {
              addTestResult(
                "performance",
                "FPS æµæš¢åº¦æ¸¬è©¦",
                "pass",
                `FPS: ${fps} (ä¸­ç­‰)`
              );
            } else {
              addTestResult(
                "performance",
                "FPS æµæš¢åº¦æ¸¬è©¦",
                "fail",
                `FPS éä½: ${fps}`
              );
            }
            completedTests++;
          }
        }
        requestAnimationFrame(countFrames);
      }

      // ç„¡éšœç¤™æ€§æ¸¬è©¦
      async function runAccessibilityTests() {
        testResults.accessibility = [];
        totalTests += 7;

        // æ¸¬è©¦ 1: æª¢æŸ¥åœ–ç‰‡ alt å±¬æ€§
        addTestResult("accessibility", "åœ–ç‰‡ alt å±¬æ€§æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const images = document.querySelectorAll("img");
        const imagesWithoutAlt = Array.from(images).filter((img) => !img.alt);

        if (imagesWithoutAlt.length === 0) {
          addTestResult(
            "accessibility",
            "åœ–ç‰‡ alt å±¬æ€§æª¢æŸ¥",
            "pass",
            `${images.length} å€‹åœ–ç‰‡éƒ½æœ‰ alt å±¬æ€§`
          );
        } else {
          addTestResult(
            "accessibility",
            "åœ–ç‰‡ alt å±¬æ€§æª¢æŸ¥",
            "fail",
            `${imagesWithoutAlt.length} å€‹åœ–ç‰‡ç¼ºå°‘ alt å±¬æ€§`
          );
        }
        completedTests++;

        // æ¸¬è©¦ 2: æª¢æŸ¥æ¨™é¡Œçµæ§‹
        addTestResult("accessibility", "æ¨™é¡Œçµæ§‹æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const headings = document.querySelectorAll("h1, h2, h3, h4, h5, h6");
        const hasH1 = document.querySelector("h1");

        if (hasH1 && headings.length > 0) {
          addTestResult(
            "accessibility",
            "æ¨™é¡Œçµæ§‹æª¢æŸ¥",
            "pass",
            `æ‰¾åˆ° H1 å’Œ ${headings.length} å€‹æ¨™é¡Œ`
          );
        } else {
          addTestResult(
            "accessibility",
            "æ¨™é¡Œçµæ§‹æª¢æŸ¥",
            "fail",
            "ç¼ºå°‘ H1 æˆ–æ¨™é¡Œçµæ§‹ä¸å®Œæ•´"
          );
        }
        completedTests++;

        // æ¸¬è©¦ 3: æª¢æŸ¥è¡¨å–®æ¨™ç±¤
        addTestResult("accessibility", "è¡¨å–®æ¨™ç±¤æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const inputs = document.querySelectorAll("input, textarea, select");
        const inputsWithoutLabel = Array.from(inputs).filter((input) => {
          const hasLabel = document.querySelector(`label[for="${input.id}"]`);
          const hasAriaLabel = input.getAttribute("aria-label");
          return !hasLabel && !hasAriaLabel;
        });

        if (inputsWithoutLabel.length === 0) {
          addTestResult(
            "accessibility",
            "è¡¨å–®æ¨™ç±¤æª¢æŸ¥",
            "pass",
            `${inputs.length} å€‹è¡¨å–®å…ƒç´ éƒ½æœ‰é©ç•¶æ¨™ç±¤`
          );
        } else {
          addTestResult(
            "accessibility",
            "è¡¨å–®æ¨™ç±¤æª¢æŸ¥",
            "fail",
            `${inputsWithoutLabel.length} å€‹è¡¨å–®å…ƒç´ ç¼ºå°‘æ¨™ç±¤`
          );
        }
        completedTests++;

        // æ¸¬è©¦ 4: æª¢æŸ¥è‰²å½©å°æ¯”åº¦ (ç°¡åŒ–ç‰ˆ)
        addTestResult("accessibility", "è‰²å½©å°æ¯”åº¦æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        // é€™æ˜¯ä¸€å€‹ç°¡åŒ–çš„å°æ¯”åº¦æª¢æŸ¥ï¼Œå¯¦éš›æ‡‰ç”¨ä¸­éœ€è¦æ›´è¤‡é›œçš„è¨ˆç®—
        const textElements = document.querySelectorAll(
          "p, span, div, a, button"
        );
        let lowContrastCount = 0;

        Array.from(textElements)
          .slice(0, 10)
          .forEach((element) => {
            const styles = window.getComputedStyle(element);
            const color = styles.color;
            const backgroundColor = styles.backgroundColor;

            // ç°¡åŒ–çš„å°æ¯”åº¦æª¢æŸ¥ (å¯¦éš›éœ€è¦æ›´ç²¾ç¢ºçš„è¨ˆç®—)
            if (color === backgroundColor || color === "rgba(0, 0, 0, 0)") {
              lowContrastCount++;
            }
          });

        if (lowContrastCount === 0) {
          addTestResult(
            "accessibility",
            "è‰²å½©å°æ¯”åº¦æª¢æŸ¥",
            "pass",
            "æœªç™¼ç¾æ˜é¡¯çš„å°æ¯”åº¦å•é¡Œ"
          );
        } else {
          addTestResult(
            "accessibility",
            "è‰²å½©å°æ¯”åº¦æª¢æŸ¥",
            "fail",
            `${lowContrastCount} å€‹å…ƒç´ å¯èƒ½æœ‰å°æ¯”åº¦å•é¡Œ`
          );
        }
        completedTests++;

        // æ¸¬è©¦ 5: æª¢æŸ¥ ARIA å±¬æ€§
        addTestResult("accessibility", "ARIA å±¬æ€§æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const ariaElements = document.querySelectorAll(
          "[aria-label], [aria-labelledby], [aria-describedby], [role]"
        );

        if (ariaElements.length > 0) {
          addTestResult(
            "accessibility",
            "ARIA å±¬æ€§æª¢æŸ¥",
            "pass",
            `æ‰¾åˆ° ${ariaElements.length} å€‹ ARIA å¢å¼·å…ƒç´ `
          );
        } else {
          addTestResult(
            "accessibility",
            "ARIA å±¬æ€§æª¢æŸ¥",
            "fail",
            "æœªæ‰¾åˆ° ARIA å±¬æ€§ï¼Œå»ºè­°æ·»åŠ ä»¥æå‡ç„¡éšœç¤™æ€§"
          );
        }
        completedTests++;

        // æ¸¬è©¦ 6: æª¢æŸ¥éµç›¤å°è¦½
        addTestResult("accessibility", "éµç›¤å°è¦½æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const focusableElements = document.querySelectorAll(
          "a, button, input, textarea, select, [tabindex]"
        );
        const nonFocusable = Array.from(focusableElements).filter((el) => {
          return el.tabIndex < 0 || el.disabled;
        });

        if (
          focusableElements.length > 0 &&
          nonFocusable.length < focusableElements.length
        ) {
          addTestResult(
            "accessibility",
            "éµç›¤å°è¦½æª¢æŸ¥",
            "pass",
            `${focusableElements.length - nonFocusable.length} å€‹å…ƒç´ å¯éµç›¤å°è¦½`
          );
        } else {
          addTestResult(
            "accessibility",
            "éµç›¤å°è¦½æª¢æŸ¥",
            "fail",
            "éµç›¤å°è¦½æ”¯æ´ä¸è¶³"
          );
        }
        completedTests++;

        // æ¸¬è©¦ 7: æª¢æŸ¥èªè¨€å±¬æ€§
        addTestResult("accessibility", "èªè¨€å±¬æ€§æª¢æŸ¥", "pending");
        await new Promise((resolve) => setTimeout(resolve, 50));

        const htmlLang = document.documentElement.lang;
        const langElements = document.querySelectorAll("[lang]");

        if (htmlLang) {
          addTestResult(
            "accessibility",
            "èªè¨€å±¬æ€§æª¢æŸ¥",
            "pass",
            `é é¢èªè¨€: ${htmlLang}`
          );
        } else {
          addTestResult(
            "accessibility",
            "èªè¨€å±¬æ€§æª¢æŸ¥",
            "fail",
            "ç¼ºå°‘é é¢èªè¨€å±¬æ€§"
          );
        }
        completedTests++;
      }

      // é è¦½å°ºå¯¸æ§åˆ¶
      function setPreviewSize(size) {
        const preview = document.getElementById("appPreview");
        const container = preview.parentElement;

        switch (size) {
          case "mobile":
            preview.style.width = "375px";
            preview.style.height = "667px";
            container.style.overflow = "auto";
            break;
          case "tablet":
            preview.style.width = "768px";
            preview.style.height = "1024px";
            container.style.overflow = "auto";
            break;
          case "desktop":
            preview.style.width = "1024px";
            preview.style.height = "768px";
            container.style.overflow = "auto";
            break;
          case "full":
            preview.style.width = "100%";
            preview.style.height = "600px";
            container.style.overflow = "hidden";
            break;
        }
      }

      // é¡¯ç¤ºæ¸¬è©¦è©³æƒ…
      function showTestDetail(category, index) {
        const result = testResults[category][index];
        const modal = document.getElementById("testDetailModal");
        const content = document.getElementById("testDetailContent");

        content.innerHTML = `
                <h4 class="font-semibold text-lg">${result.name}</h4>
                <div class="grid grid-cols-2 gap-4 mt-4">
                    <div>
                        <span class="font-medium">ç‹€æ…‹:</span>
                        <span class="${
                          result.status === "pass"
                            ? "text-green-600"
                            : result.status === "fail"
                            ? "text-red-600"
                            : "text-yellow-600"
                        }">
                            ${
                              result.status === "pass"
                                ? "é€šé"
                                : result.status === "fail"
                                ? "å¤±æ•—"
                                : "é€²è¡Œä¸­"
                            }
                        </span>
                    </div>
                    <div>
                        <span class="font-medium">è€—æ™‚:</span> ${
                          result.duration
                        }ms
                    </div>
                </div>
                <div class="mt-4">
                    <span class="font-medium">è©³ç´°è³‡è¨Š:</span>
                    <div class="bg-gray-50 p-3 rounded mt-2 text-sm">${
                      result.details || "ç„¡è©³ç´°è³‡è¨Š"
                    }</div>
                </div>
                <div class="mt-4">
                    <span class="font-medium">æ™‚é–“æˆ³è¨˜:</span>
                    <div class="text-sm text-gray-600">${new Date(
                      result.timestamp
                    ).toLocaleString("zh-TW")}</div>
                </div>
            `;

        modal.classList.remove("hidden");
      }

      function closeTestDetail() {
        document.getElementById("testDetailModal").classList.add("hidden");
      }

      // å…¨åŸŸéµç›¤äº‹ä»¶
      document.addEventListener("keydown", function (e) {
        if (e.key === "Escape") {
          closeTestDetail();
        }
      });

      // é»æ“Šæ¨¡æ…‹çª—å¤–éƒ¨é—œé–‰
      document
        .getElementById("testDetailModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            closeTestDetail();
          }
        });
    </script>
  </body>
</html>

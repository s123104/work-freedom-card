<!--
  📦 模組：社畜解放卡
  🕒 最後更新：2025-06-18T15:30:00+08:00
  🧑‍💻 作者/更新者：@s123104
  🔢 版本：v2.1.0
  📝 摘要：智能PWA模態窗重構、系統自動檢測、近期記錄UI優化、編輯功能完善
-->
<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes, maximum-scale=5.0"
    />

    <!-- Google Search Console 驗證 -->
    <meta name="google-site-verification" content="qv173AV71hqFbIb8pECKsUQQJUb-4O49UNPmOBUgw98" />

    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX', {
        page_title: '社畜解放卡',
        page_location: window.location.href,
        custom_map: {'custom_parameter_1': 'mood_selection'}
      });
    </script>

    <!-- SEO: 基本 Meta 標籤 -->
    <title>社畜解放卡 - 職場壓力管理工具 | 離職集點卡 | 厭世指數分析</title>
    <meta
      name="description"
      content="社畜解放卡是免費開源的職場壓力管理工具！支援六大心情分類記錄每日職場心情與鳥事，集滿100點離職點數邁向自由。提供厭世指數分析、AI洞察建議、成就系統，支援PWA離線使用。幫助上班族管理工作壓力，追蹤職涯發展。"
    />
    <meta
      name="keywords"
      content="社畜解放卡, 離職集點卡, 職場壓力管理, 工作心情記錄, 厭世指數, 上班族工具, 職場生存, 離職計畫, 工作壓力, 職涯規劃, PWA應用, 免費工具, 開源專案, AI分析, 心理健康, 職場厭世, 工作倦怠, 離職準備, 職場情緒, 壓力追蹤, 職場霸凌, 六大心情分類"
    />
    <meta name="author" content="s123104" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="bingbot" content="index, follow" />
    <meta name="language" content="zh-TW" />
    <meta name="geo.region" content="TW" />
    <meta name="geo.country" content="Taiwan" />
    <meta name="distribution" content="global" />
    <meta name="rating" content="general" />
    <meta name="revisit-after" content="1 days" />
    <link rel="canonical" href="https://s123104.github.io/work-freedom-card/" />

    <!-- SEO: Open Graph (for Facebook, LinkedIn, etc.) -->
    <meta property="og:title" content="社畜解放卡 - 職場壓力管理工具 | 離職集點卡" />
    <meta
      property="og:description"
      content="免費開源的職場壓力管理工具！支援六大心情分類記錄每日職場心情與鳥事，集滿100點離職點數邁向自由。提供厭世指數分析、AI洞察建議、成就系統，支援PWA離線使用。"
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://s123104.github.io/work-freedom-card/"
    />
    <meta
      property="og:image"
      content="https://s123104.github.io/work-freedom-card/og-image.png"
    />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="社畜解放卡 - 職場壓力管理工具介面預覽" />
    <meta property="og:site_name" content="社畜解放卡" />
    <meta property="og:locale" content="zh_TW" />

    <!-- SEO: Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="社畜解放卡 - 職場壓力管理工具 | 離職集點卡" />
    <meta
      name="twitter:description"
      content="免費開源的職場壓力管理工具！支援六大心情分類記錄每日職場心情與鳥事，集滿100點離職點數邁向自由。提供厭世指數分析、AI洞察建議、成就系統，支援PWA離線使用。"
    />
    <meta
      name="twitter:image"
      content="https://s123104.github.io/work-freedom-card/og-image.png"
    />
    <meta name="twitter:image:alt" content="社畜解放卡 - 職場壓力管理工具介面預覽" />
    <meta name="twitter:creator" content="@s123104" />
    <meta name="twitter:site" content="@s123104" />

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#3da35d" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="社畜解放卡" />
    <link rel="apple-touch-icon" href="icon-192.png" />
    <link rel="icon" type="image/png" href="icon-192.png" />
    <link rel="manifest" href="./manifest.json" />

    <!-- SEO: JSON-LD Structured Data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "社畜解放卡",
        "alternateName": ["離職集點卡", "職場壓力管理工具", "Work Freedom Card"],
        "description": "免費開源的職場壓力管理工具！支援六大心情分類記錄每日職場心情與鳥事，集滿100點離職點數邁向自由。提供厭世指數分析、AI洞察建議、成就系統，支援PWA離線使用。幫助上班族管理工作壓力，追蹤職涯發展。",
        "applicationCategory": ["ProductivityApplication", "HealthApplication", "UtilitiesApplication"],
        "operatingSystem": ["Web", "iOS", "Android", "Windows", "macOS", "Linux"],
        "url": "https://s123104.github.io/work-freedom-card/",
        "downloadUrl": "https://s123104.github.io/work-freedom-card/",
        "installUrl": "https://s123104.github.io/work-freedom-card/",
        "screenshot": "https://s123104.github.io/work-freedom-card/og-image.png",
        "image": "https://s123104.github.io/work-freedom-card/icon-512.png",
        "author": {
          "@type": "Person",
          "name": "s123104",
          "url": "https://github.com/s123104"
        },
        "creator": {
          "@type": "Person", 
          "name": "s123104",
          "url": "https://github.com/s123104"
        },
        "publisher": {
          "@type": "Organization",
          "name": "s123104",
          "url": "https://github.com/s123104"
        },
        "offers": { 
          "@type": "Offer", 
          "price": "0",
          "priceCurrency": "USD",
          "availability": "https://schema.org/InStock"
        },
        "license": "https://opensource.org/licenses/MIT",
        "softwareVersion": "2.1.0",
        "datePublished": "2025-01-01",
        "dateModified": "2025-06-18T15:30:00+08:00",
        "keywords": "社畜解放卡, 離職集點卡, 職場壓力管理, 工作心情記錄, 厭世指數, 上班族工具, 職場生存, 離職計畫, PWA應用, 免費工具, 開源專案",
        "inLanguage": "zh-TW",
        "isAccessibleForFree": true,
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareRequirements": "Web Browser",
        "memoryRequirements": "1MB",
        "storageRequirements": "5MB",
        "featureList": [
          "離職集點系統",
          "六大心情分類記錄", 
          "厭世指數分析",
          "成就系統",
          "AI分析匯出",
          "PWA離線支援",
          "數據隱私保護",
          "響應式設計"
        ],
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "reviewCount": "258",
          "bestRating": "5",
          "worstRating": "1"
        }
      }
    </script>

    <!-- Tailwind CSS -->
    <!-- 注意：生產環境建議使用本地 Tailwind CSS 文件 -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio"></script>
    <!-- Google Fonts & Font Awesome Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Kalam:wght@400;700&family=Caveat:wght@400;600;700&family=Dancing+Script:wght@400;600;700&family=Indie+Flower&family=Shadows+Into+Light&family=Amatic+SC:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <!-- Remix Icon -->
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>

    <!-- Tailwind Config -->
    <script src="tailwind.config.js"></script>

    <!-- 外部樣式表 -->
    <link rel="stylesheet" href="styles.css">
  </head>

  <body
    class="bg-gradient-to-br from-primary-50 via-white to-accent-50 min-h-screen font-sans overflow-x-hidden"
  >
    <!-- Annoyance Score Feedback Element -->
    <div id="annoyanceFeedback" class="hidden"></div>

    <!-- Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none -z-10">
      <div
        class="absolute top-20 left-10 w-32 h-32 bg-primary-200 rounded-full opacity-20 animate-float"
      ></div>
      <div
        class="absolute bottom-20 right-20 w-24 h-24 bg-accent-200 rounded-full opacity-20 animate-float"
        style="animation-delay: -2s"
      ></div>
    </div>

    <!-- Header -->
    <header class="relative text-center py-6 sm:py-8 md:py-12 animate-fade-in">
      <div class="container mx-auto px-4">

        <h1
          class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-primary-800 mb-3 sm:mb-4 tracking-wide relative"
        >
          <img src="./icon.png" alt="社畜解放卡" class="w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-2xl shadow-lg animate-bounce-slow inline-block mr-4" style="background: transparent;"> 社畜解放卡
          <span class="inline-block animate-pulse-slow"><i class="fas fa-sparkles text-yellow-500"></i></span>
        </h1>
        <p
          class="text-base sm:text-lg md:text-xl text-primary-600 font-medium"
          id="progressText"
        >
          共100格，集滿離職
        </p>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 pb-4">
      <!-- Grid Area -->
      <div
        class="glass-effect rounded-3xl shadow-2xl p-4 sm:p-6 md:p-8 mb-6 animate-slide-up"
      >
        <div class="text-center mb-4">
          <h2 class="text-xl sm:text-2xl font-bold text-primary-800 mb-2">
            <i class="fas fa-calendar-check mr-2"></i>我的離職集點進度
          </h2>
          <p class="text-primary-600 text-xs sm:text-sm">
            <i class="fas fa-info-circle mr-1"></i>短按標記日期，
            <span
              class="bg-primary-100 px-2 py-1 rounded-full font-bold animate-pulse"
              >長按記錄詳細事件</span
            >
          </p>
        </div>
        <div
          class="grid grid-cols-8 md:grid-cols-10 gap-1 sm:gap-2 max-w-4xl mx-auto"
          id="gridContainer"
        ></div>
        <!-- Quote Display (優化位置避免遮蔽) -->
        <div id="quoteDisplay" class="hidden">
          <div
            class="quote-container text-center fixed top-4 left-4 right-4 z-20 bg-gradient-to-r from-green-700/95 to-green-600/95 p-3 sm:p-4 rounded-lg shadow-lg transform transition-all duration-300 max-w-sm mx-auto backdrop-blur-sm"
          >
            <i class="fas fa-quote-left text-lg sm:text-xl mb-2 opacity-70"></i>
            <p
              class="text-sm sm:text-base font-handwrite-3 leading-relaxed mb-3"
              id="quoteText"
            ></p>
            <button
              onclick="hideQuote()"
              class="bg-white/20 hover:bg-white/30 px-3 py-1.5 rounded-full text-xs sm:text-sm transition-all duration-300 flex items-center mx-auto"
            >
              <i class="fas fa-times mr-1"></i>收起
            </button>
          </div>
        </div>
      </div>

      <!-- Stats & Chart -->
      <div class="stats-container grid md:grid-cols-2 gap-4 mb-6">
        <div
          class="glass-effect rounded-2xl shadow-xl p-4 sm:p-6 animate-slide-up"
          style="animation-delay: 0.2s"
        >
          <h3
            class="text-lg sm:text-xl font-bold text-primary-800 mb-4 flex items-center"
          >
            <i class="fas fa-chart-pie mr-2 text-primary-600"></i>進度統計
          </h3>
          <div class="flex items-center justify-center mb-4">
            <div class="relative w-24 h-24 sm:w-32 sm:h-32">
              <svg class="progress-ring w-full h-full" viewBox="0 0 120 120">
                <circle
                  cx="60"
                  cy="60"
                  r="54"
                  fill="none"
                  stroke="#e5e7eb"
                  stroke-width="8"
                />
                <circle
                  cx="60"
                  cy="60"
                  r="54"
                  fill="none"
                  stroke="#3da35d"
                  stroke-width="8"
                  stroke-linecap="round"
                  class="progress-ring-circle"
                  id="progressCircle"
                  stroke-dasharray="0 339.292"
                />
              </svg>
              <div
                class="absolute inset-0 flex items-center justify-center text-center"
              >
                <div>
                  <div
                    class="text-xl sm:text-2xl font-bold text-primary-700"
                    id="filledCount"
                  >
                    0
                  </div>
                  <div class="text-xs text-primary-600">已完成</div>
                </div>
              </div>
            </div>
          </div>
          <div class="space-y-2">
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-yellow-600">
                  <path d="M9 10a1 1 0 11-2 0 1 1 0 012 0zm6 0a1 1 0 11-2 0 1 1 0 012 0zm-4 5a4 4 0 01-4-4h8a4 4 0 01-4 4zm4.5-8.5a1.5 1.5 0 00-3 0h3zm-4-3a.5.5 0 001 0h-1zM12 2a10 10 0 100 20 10 10 0 000-20z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
                </svg>錢途茫茫
              </span>
              <span class="font-semibold text-yellow-600" id="moneyMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-red-600">
                  <path d="M12 2a10 10 0 100 20 10 10 0 000-20zM9 15s1.5-2 3-2 3 2 3 2M9 9h.01M15 9h.01" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
                </svg>身心俱疲
              </span>
              <span class="font-semibold text-red-600" id="burnoutMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-indigo-600">
                  <path d="M12 2a10 10 0 100 20 10 10 0 000-20zM8 9l8 6M8 15L16 9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
                </svg>鳥事一堆
              </span>
              <span class="font-semibold text-indigo-600" id="annoyingMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-gray-600">
                  <path d="M12 2a10 10 0 100 20 10 10 0 000-20zM9 12h6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
                </svg>缺乏成長
              </span>
              <span class="font-semibold text-gray-600" id="stuckMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-green-600">
                  <path d="M12 2a10 10 0 100 20 10 10 0 000-20zM8 14s2-3 4-3 4 3 4 3M9 9h.01M15 9h.01" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"></path>
                </svg>破爛心情
              </span>
              <span class="font-semibold text-green-600" id="badMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center">
              <span class="text-sm text-neutral-600">
                <svg viewBox="0 0 24 24" class="w-4 h-4 inline mr-2 stroke-current text-orange-600">
                  <path d="M12 2a10 10 0 100 20 10 10 0 000-20zM8 8h8M8 12h8M8 16h8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/><path d="M16 8l2-2M16 16l2 2M8 8l-2-2M8 16l-2 2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                </svg>職場霸凌
              </span>
              <span class="font-semibold text-orange-600" id="bullyingMoodCount">0</span>
            </div>
            <div class="flex justify-between items-center pt-2 border-t border-gray-200">
              <span class="text-sm text-neutral-600"
                ><i class="fas fa-percentage mr-2 text-accent-500"></i
                >完成率</span
              ><span class="font-semibold text-accent-600" id="completionRate"
                >0%</span
              >
            </div>
          </div>
          <div class="mt-6 space-y-2">
            <button
              onclick="openAiExportModal()"
              class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white px-4 py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105"
            >
              <i class="fas fa-magic-wand-sparkles mr-2"></i>匯出至 AI 分析
            </button>
            <button
              onclick="showClearConfirm()"
              class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white px-4 py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-105"
            >
              <i class="fas fa-trash-alt mr-2"></i>清空所有記錄
            </button>
          </div>
        </div>
        <div
          class="glass-effect rounded-2xl shadow-xl p-4 sm:p-6 animate-slide-up"
          style="animation-delay: 0.4s"
        >
          <h3
            class="text-lg sm:text-xl font-bold text-primary-800 mb-4 flex items-center"
          >
            <i class="fas fa-chart-line mr-2 text-primary-600"></i>心情趨勢
          </h3>
          <div class="relative h-64"><canvas id="dailyChart"></canvas></div>
          <p class="mt-4 text-center text-primary-600 text-xs sm:text-sm">
            <i class="fas fa-sync-alt fa-spin mr-1"></i
            >圖表即時更新，反映最新心情狀態
          </p>
        </div>

        <!-- 成就系統 -->
        <div
          class="glass-effect rounded-2xl shadow-xl p-4 sm:p-6 animate-slide-up md:col-span-2"
          style="animation-delay: 0.5s"
        >
          <h3
            class="text-lg sm:text-xl font-bold text-primary-800 mb-4 flex items-center justify-between"
          >
            <span>
              <i class="fas fa-trophy mr-2 text-yellow-600"></i>成就收集
            </span>
            <span class="text-sm font-normal text-neutral-500" id="achievementProgress">0/10</span>
          </h3>
          <div id="achievementsContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-3 mb-4">
            <!-- 成就會動態生成 -->
          </div>
          <div class="text-xs text-neutral-500 text-center bg-blue-50 p-3 rounded-lg">
            💡 <strong>隱藏彩蛋提示：</strong>試試在鍵盤上輸入 <code class="bg-white px-1 rounded">↑↑↓↓←→←→BA</code> 來發現驚喜！
          </div>
        </div>
      </div>

      <!-- Analysis & Records -->
      <div class="analysis-container grid md:grid-cols-2 gap-4 mb-6">
        <div
          class="glass-effect rounded-2xl shadow-xl p-4 sm:p-6 animate-slide-up"
          style="animation-delay: 0.6s"
        >
          <h3
            class="text-lg sm:text-xl font-bold text-primary-800 mb-4 flex items-center"
          >
            <i class="fas fa-fire-alt mr-2 text-red-500"></i>厭世指數分析
          </h3>
          <div class="bg-red-50 p-6 rounded-2xl text-center">
            <div class="text-sm text-red-700 mb-2">總厭世指數</div>
            <div
              id="annoyanceIndexTotal"
              class="text-5xl font-bold text-red-600"
            >
              0
            </div>
            <p id="annoyanceLevel" class="text-red-500 font-semibold mt-2">
              內心毫無波瀾
            </p>
          </div>
          <div class="mt-4">
            <p class="text-sm text-neutral-600 mb-2 font-semibold">
              主要厭世來源：
            </p>
            <ul
              id="topAnnoyanceKeywords"
              class="text-sm text-neutral-500 space-y-1"
            >
              <li>尚無數據</li>
            </ul>
          </div>

          <!-- 關鍵字雲區塊 -->
          <div class="mt-6">
            <p
              class="text-sm text-neutral-600 mb-2 font-semibold flex items-center"
            >
              <i class="fas fa-cloud mr-2 text-blue-400"></i>厭世關鍵字雲
            </p>
            <div
              id="keywordCloud"
              class="bg-blue-50 p-4 rounded-xl min-h-[120px] flex items-center justify-center flex-wrap"
            >
              <p class="text-neutral-500 text-center">
                尚無足夠數據生成關鍵字雲
              </p>
            </div>
          </div>
        </div>
        <div
          class="glass-effect rounded-2xl shadow-xl p-4 sm:p-6 animate-slide-up"
          style="animation-delay: 0.8s"
        >
          <h3
            class="text-lg sm:text-xl font-bold text-primary-800 mb-4 flex items-center"
          >
            <i class="fas fa-history mr-2 text-primary-600"></i>近期記錄
          </h3>
          <div id="recentRecords" class="space-y-3 max-h-80 overflow-y-auto pr-2">
            <p class="text-neutral-500 text-center py-8">
              <i class="fas fa-inbox text-3xl mb-2 block"></i>尚無記錄
            </p>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer
      class="text-center py-6 text-primary-600 animate-fade-in"
      style="animation-delay: 1s"
    >
      <p class="text-sm sm:text-base mb-3 font-handwrite-4">
        人生苦短，別浪費在不喜歡的地方。
      </p>
      <div class="text-xs opacity-75 mb-4 space-y-2">
        <p>© 2025 社畜解放卡. All Rights Reserved.</p>
        <p class="flex items-center justify-center gap-2">
          <i class="fab fa-github"></i>
          開源專案：
          <a href="https://github.com/s123104/work-freedom-card" target="_blank" class="text-primary-700 hover:text-primary-800 underline">
            github.com/s123104/work-freedom-card
          </a>
        </p>
        <p class="text-xs">
          作者 <a href="https://github.com/s123104" target="_blank" class="text-primary-700 hover:text-primary-800 underline">@s123104</a> 
          - 免費使用，歡迎 Fork 和貢獻
        </p>
      </div>
    </footer>

    <!-- Share Button -->
    <button id="shareBtnTrigger" class="share-trigger" aria-label="分享此頁面">
      <i class="fas fa-share-alt"></i>
    </button>

    <!-- Share Modal -->
    <div id="shareModal" class="generic-modal" aria-hidden="true" role="dialog">
      <div class="modal-box max-w-md">
        <button
          class="close-btn"
          aria-label="關閉"
          onclick="closeModal('shareModal')"
        >
          ×
        </button>
        
        <!-- Preview Image -->
        <div class="mb-4 text-center">
          <img src="./og-image.png" alt="社畜解放卡預覽" class="w-full rounded-lg shadow-md" />
        </div>
        
        <h3 class="text-xl font-bold text-center mb-2">分享你的離職進度</h3>
        <p class="mt-2 text-gray-600 text-center">讓朋友一起見證你的自由之路！</p>
        <p id="shareAnnoyanceIndex" class="text-red-600 font-semibold mt-1 text-center"></p>
        
        <!-- Author Info -->
        <div class="bg-gray-50 rounded-lg p-3 mt-4 mb-4">
          <div class="flex items-center justify-center gap-2 text-sm text-gray-600">
            <i class="fas fa-user-circle"></i>
            <span>作者：</span>
            <a href="https://threads.net/@azlife_1224" target="_blank" class="text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
              <i class="fa-brands fa-threads text-sm"></i>
              azlife_1224
            </a>
          </div>
        </div>
        
        <div class="share-options">
          <button id="copyLinkBtn" class="share-btn share-btn--copy">
            <i class="fas fa-copy"></i>複製文案
          </button>
          <button id="shareToThreadsBtn" class="share-btn share-btn--threads">
            <i class="fa-brands fa-threads"></i>Threads
          </button>
          <button id="shareToTwitterBtn" class="share-btn share-btn--twitter">
            <i class="fab fa-twitter"></i>Twitter
          </button>
          <button id="shareToLineBtn" class="share-btn share-btn--line">
            <i class="fab fa-line"></i>LINE
          </button>
        </div>
      </div>
    </div>

    <!-- Edit Record Modal -->
    <div id="editRecordModal" class="generic-modal" aria-hidden="true" role="dialog">
      <div class="modal-box max-w-md">
        <button
          class="close-btn"
          aria-label="關閉"
          onclick="closeModal('editRecordModal')"
        >
          ×
        </button>
        
        <h3 class="text-xl font-bold text-center mb-4">
          <i class="fas fa-edit text-primary-600 mr-2"></i>編輯記錄
        </h3>
        
        <form id="editRecordForm" class="space-y-4">
          <div>
            <label for="editEventDate" class="block text-sm font-medium text-neutral-700 mb-2">日期</label>
            <input
              type="date"
              id="editEventDate"
              readonly
              class="w-full border-gray-300 rounded-lg bg-gray-50 cursor-not-allowed"
            />
          </div>
          
          <div>
            <label for="editMoodSelect" class="block text-sm font-medium text-neutral-700 mb-2">心情 (離職六大原因)</label>
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-2" id="editMoodButtons">
              <button type="button" class="edit-mood-btn" data-mood="money">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">錢途茫茫</span>
              </button>
              <button type="button" class="edit-mood-btn" data-mood="burnout">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">身心俱疲</span>
              </button>
              <button type="button" class="edit-mood-btn" data-mood="annoying">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">鳥事一堆</span>
              </button>
              <button type="button" class="edit-mood-btn" data-mood="stuck">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">缺乏成長</span>
              </button>
              <button type="button" class="edit-mood-btn" data-mood="bad">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">破爛心情</span>
              </button>
              <button type="button" class="edit-mood-btn" data-mood="bullying">
                <div class="edit-mood-icon"></div>
                <span class="text-xs mt-1">職場霸凌</span>
              </button>
            </div>
          </div>
          
          <div>
            <label for="editEventDescription" class="block text-sm font-medium text-neutral-700 mb-2">事件描述</label>
            <textarea
              id="editEventDescription"
              rows="3"
              placeholder="今天發生了什麼鳥事？"
              class="w-full border-gray-300 rounded-lg"
            ></textarea>
            <div class="mt-2 flex items-center justify-between text-xs">
              <span class="text-gray-500">厭世指數：</span>
              <span id="editAnnoyanceScore" class="bg-red-100 text-red-700 px-2 py-1 rounded-full font-medium">0 分</span>
            </div>
          </div>
        </form>
        
        <div class="flex gap-3 mt-6">
          <button
            type="button"
            onclick="closeModal('editRecordModal')"
            class="flex-1 bg-neutral-200 text-neutral-700 py-3 rounded-xl"
          >
            取消
          </button>
          <button
            type="button"
            onclick="saveEditedRecord()"
            class="flex-1 bg-primary-500 text-white py-3 rounded-xl"
          >
            儲存
          </button>
        </div>
      </div>
    </div>

    <!-- AI Export Modal -->
    <div
      id="aiExportModal"
      class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4"
    >
      <div class="modal-content bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh]">
        <button
          class="absolute top-4 right-4 z-10 w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center text-gray-500 hover:text-gray-700 transition-colors"
          aria-label="關閉"
          onclick="closeModal('aiExportModal')"
        >
          <i class="fas fa-times text-sm"></i>
        </button>
        
                <div class="p-6 sm:p-8 space-y-6">
          <!-- Header Section -->
          <div class="rounded-lg bg-gradient-to-r from-indigo-500 to-purple-600 text-white p-6">
            <div class="flex items-center gap-3 mb-3">
              <i class="fas fa-magic-wand-sparkles text-white text-2xl"></i>
              <h3 class="text-2xl font-semibold">AI 深度分析</h3>
            </div>
            <p class="text-indigo-100">生成專業的 AI 分析提示詞，獲取個人化的職涯建議</p>
          </div>

          <!-- Statistics Cards -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="rounded-lg bg-gradient-to-br from-blue-500 to-blue-600 text-white p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-white/80 text-xs font-medium">總記錄數</p>
                  <p class="text-2xl font-bold text-white" id="totalRecordsCount">16</p>
                </div>
                <i class="fas fa-calendar text-white/80 text-xl"></i>
              </div>
            </div>
            <div class="rounded-lg bg-gradient-to-br from-red-500 to-red-600 text-white p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-white/80 text-xs font-medium">總厭世指數</p>
                  <p class="text-2xl font-bold text-white" id="totalBurnoutScore">0</p>
                </div>
                <i class="fas fa-fire text-white/80 text-xl"></i>
              </div>
            </div>
            <div class="rounded-lg bg-gradient-to-br from-orange-500 to-orange-600 text-white p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-white/80 text-xs font-medium">平均指數</p>
                  <p class="text-2xl font-bold text-white" id="averageBurnoutScore">0.0</p>
                </div>
                <i class="fas fa-chart-line text-white/80 text-xl"></i>
              </div>
            </div>
            <div class="rounded-lg bg-gradient-to-br from-purple-500 to-purple-600 text-white p-4">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-white/80 text-xs font-medium">最高指數</p>
                  <p class="text-2xl font-bold text-white" id="maxBurnoutScore">0</p>
                </div>
                <i class="fas fa-star text-white/80 text-xl"></i>
              </div>
            </div>
          </div>

          <!-- Generate Button -->
          <div class="rounded-lg border bg-white shadow-sm">
            <div class="p-6">
              <h3 class="text-2xl font-semibold mb-2 flex items-center gap-2">
                <i class="fas fa-magic text-lg"></i>
                生成 AI 分析提示詞
        </h3>
              <p class="text-sm text-gray-600 mb-4">將您的職場心情數據轉換為專業的 AI 分析提示詞</p>
              <button onclick="generateAIPrompt()" class="w-full bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 transform hover:scale-[1.02] flex items-center justify-center gap-2">
                <i class="fas fa-magic-wand-sparkles"></i>
                生成 AI 分析提示詞
        </button>
            </div>
          </div>

          <!-- AI Prompt Output -->
          <div id="aiPromptSection" class="hidden rounded-lg border bg-white shadow-sm">
            <div class="p-6">
              <div class="flex items-center justify-between mb-4">
                <h3 class="text-2xl font-semibold flex items-center gap-2">
                  <i class="fas fa-file-alt text-lg"></i>
                  AI 分析提示詞
                </h3>
                <div class="flex items-center gap-2">
                  <span class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold" id="promptCharCount">0 字符</span>
                </div>
              </div>
              <label for="ai-prompt-output" class="sr-only">AI 分析提示詞內容</label>
              <textarea id="ai-prompt-output" readonly="" rows="12" placeholder="生成的提示詞將顯示在這裡..." class="w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-sm font-mono resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent" aria-describedby="promptCharCount"></textarea>
              
              <!-- Action Buttons -->
              <div class="mt-4 space-y-3">
                <button id="copyAIPromptBtn" class="w-full bg-gray-100 hover:bg-gray-200 text-gray-900 px-4 py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2">
                  <i class="fas fa-copy"></i>
                  複製提示詞
                </button>
                
                <!-- AI Service Buttons -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                  <button onclick="openAIService('chatgpt')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium">
                    <i class="fas fa-external-link-alt text-xs"></i>
                    ChatGPT
                  </button>
                  <button onclick="openAIService('claude')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium">
                    <i class="fas fa-external-link-alt text-xs"></i>
                    Claude
                  </button>
                  <button onclick="openAIService('gemini')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium">
                    <i class="fas fa-external-link-alt text-xs"></i>
                    Gemini
                  </button>
                  <button onclick="openAIService('grok')" class="flex items-center justify-center gap-2 px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm font-medium">
                    <i class="fas fa-external-link-alt text-xs"></i>
                    Grok
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Usage Instructions -->
          <div class="rounded-lg bg-gradient-to-br from-amber-50 to-orange-50 border border-amber-200">
            <div class="p-6">
              <h3 class="text-2xl font-semibold mb-4 flex items-center gap-2 text-amber-800">
                <i class="fas fa-info-circle text-lg"></i>
                使用說明
              </h3>
              <ol class="list-decimal list-inside space-y-2 text-sm text-amber-700">
                <li>點擊「生成 AI 分析提示詞」按鈕</li>
                <li>複製生成的提示詞</li>
                <li>選擇您偏好的 AI 服務（ChatGPT、Claude、Gemini 或 Grok）</li>
                <li>將提示詞貼到 AI 對話框中</li>
                <li>獲得專業的職場心情分析和建議</li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Event Modal -->
    <div
      id="eventModal"
      class="fixed inset-0 modal-backdrop hidden z-50 p-4"
    >
      <div class="modal-content p-6 sm:p-8 w-full max-w-lg">
        <h3 class="text-xl font-bold text-primary-800 mb-4 text-center">
          記錄事件
        </h3>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2"
              >日期</label
            >
            <input
              type="date"
              id="eventDate"
              class="w-full border-gray-300 rounded-lg"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2"
              >心情 (離職六大原因)</label
            >
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-2">
              <button class="mood-btn" data-mood="money">
                <div id="moodIconMoney"></div>
                <span class="text-xs mt-1">錢途茫茫</span>
              </button>
              <button class="mood-btn" data-mood="burnout">
                <div id="moodIconBurnout"></div>
                <span class="text-xs mt-1">身心俱疲</span>
              </button>
              <button class="mood-btn" data-mood="annoying">
                <div id="moodIconAnnoying"></div>
                <span class="text-xs mt-1">鳥事一堆</span>
              </button>
              <button class="mood-btn" data-mood="stuck">
                <div id="moodIconStuck"></div>
                <span class="text-xs mt-1">缺乏成長</span>
              </button>
              <button class="mood-btn" data-mood="bad">
                <div id="moodIconBad"></div>
                <span class="text-xs mt-1">破爛心情</span>
              </button>
              <button class="mood-btn" data-mood="bullying">
                <div id="moodIconBullying"></div>
                <span class="text-xs mt-1">職場霸凌</span>
              </button>
            </div>
          </div>
          <div>
            <label
              for="eventDescription"
              class="block text-sm font-medium text-neutral-700 mb-2"
              >事件描述</label
            >
            <textarea
              id="eventDescription"
              rows="3"
              placeholder="今天發生了什麼鳥事？"
              class="w-full border-gray-300 rounded-lg"
            ></textarea>
          </div>
          <div>
            <label class="block text-sm font-medium text-neutral-700 mb-2"
              >爛事標籤</label
            >
            <div
              id="presetButtonsContainer"
              class="flex flex-wrap gap-2 mb-2"
            ></div>
            <div class="flex items-center gap-2">
              <div class="flex-grow relative">
                <input
                  type="text"
                  id="customPresetInput"
                  placeholder="新增自訂爛事"
                  class="w-full border-gray-300 rounded-lg pr-16"
                />
                <button
                  onclick="addCustomPreset()"
                  class="absolute right-0 top-0 bottom-0 bg-primary-500 text-white px-4 rounded-r-lg"
                >
                  新增
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="flex gap-3 mt-6">
          <button
            onclick="closeEventModal()"
            class="flex-1 bg-neutral-200 text-neutral-700 py-3 rounded-xl"
          >
            取消
          </button>
          <button
            onclick="saveEvent()"
            class="flex-1 bg-primary-500 text-white py-3 rounded-xl"
          >
            儲存
          </button>
        </div>
      </div>
    </div>

    <!-- Modals for Confirmation & PWA -->
    <div
      id="confirmModal"
      class="generic-modal"
      aria-hidden="true"
      role="dialog"
    >
      <div class="modal-box">
        <h3 class="text-xl font-bold">確認清空</h3>
        <p class="my-4">此操作無法復原，確定嗎？</p>
        <div class="flex gap-4">
          <button
            class="flex-1 bg-gray-200 py-2 rounded-lg"
            onclick="closeModal('confirmModal')"
          >
            取消</button
          ><button
            class="flex-1 bg-red-500 text-white py-2 rounded-lg"
            onclick="confirmClearAll()"
          >
            確認
          </button>
        </div>
      </div>
    </div>
    <div id="installPrompt" class="hidden"></div>
    <!-- Smart PWA Installation Modal -->
    <div
      id="iosPwaModal"
      class="generic-modal"
      aria-hidden="true"
      role="dialog"
    >
      <div class="modal-box max-w-3xl max-h-[95vh] overflow-y-auto">
        <button
          class="close-btn"
          aria-label="關閉"
          onclick="handleIosPwaClose()"
        >
          ×
        </button>
        
        <!-- Header Section -->
        <div class="text-center mb-8">
          <div class="mb-6">
            <div class="w-20 h-20 mx-auto bg-gradient-to-br from-primary-500 to-accent-500 rounded-2xl flex items-center justify-center mb-4 shadow-lg">
              <i class="fas fa-mobile-alt text-3xl text-white"></i>
            </div>
          </div>
          <h2 class="text-2xl sm:text-3xl font-bold text-primary-800 mb-3">
            安裝社畜解放卡
          </h2>
          <p class="text-gray-600 text-sm sm:text-base leading-relaxed max-w-md mx-auto">
            將應用程式安裝到您的設備，享受更好的使用體驗！
          </p>
        </div>

        <!-- Benefits Section -->
        <div class="mb-8 bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 p-6 rounded-2xl border border-blue-100 shadow-sm">
          <h3 class="font-bold text-blue-900 mb-5 flex items-center text-lg">
            <i class="fas fa-star mr-3 text-yellow-500"></i>安裝優勢
          </h3>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div class="flex items-center gap-3 text-blue-800">
              <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <i class="fas fa-rocket text-blue-600 text-sm"></i>
              </div>
              <span class="text-sm font-medium">更快的載入速度</span>
            </div>
            <div class="flex items-center gap-3 text-blue-800">
              <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <i class="fas fa-wifi-slash text-green-600 text-sm"></i>
              </div>
              <span class="text-sm font-medium">離線也能使用</span>
            </div>
            <div class="flex items-center gap-3 text-blue-800">
              <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <i class="fas fa-expand text-purple-600 text-sm"></i>
              </div>
              <span class="text-sm font-medium">全螢幕沉浸體驗</span>
            </div>
            <div class="flex items-center gap-3 text-blue-800">
              <div class="w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0">
                <i class="fas fa-home text-orange-600 text-sm"></i>
              </div>
              <span class="text-sm font-medium">主畫面快速啟動</span>
            </div>
          </div>
        </div>

        <!-- Dynamic Installation Instructions -->
        <div id="installationInstructions" class="space-y-5 mb-6">
          <!-- Instructions will be dynamically generated based on user's device -->
        </div>

        <!-- Universal Fallback Section -->
        <div id="universalInstructions" class="mb-8 bg-amber-50 p-5 rounded-xl border border-amber-200">
          <div class="flex items-start gap-3">
            <i class="fas fa-lightbulb text-amber-600 mt-0.5 text-lg"></i>
            <div class="text-sm text-amber-800 flex-1">
              <p class="font-semibold mb-2">💡 找不到安裝選項？</p>
              <ul class="space-y-1 list-disc list-inside text-amber-700 leading-relaxed">
                <li>確保使用最新版本的瀏覽器</li>
                <li>某些瀏覽器可能不支援 PWA 安裝</li>
                <li>您仍可以正常使用網頁版本</li>
                <li>建議使用 Chrome、Safari 或 Edge 瀏覽器</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Bottom Actions -->
        <div class="space-y-4">
          <div class="flex items-center justify-center gap-3 text-sm">
            <input 
              type="checkbox" 
              id="iosPwaDontShow" 
              class="w-4 h-4 text-primary-600 bg-gray-100 border-gray-300 rounded focus:ring-primary-500 focus:ring-2"
            />
            <label for="iosPwaDontShow" class="text-gray-600 cursor-pointer select-none">
              下次不再顯示此提示
            </label>
          </div>
          
          <div class="flex gap-3">
            <button 
              class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-3 px-6 rounded-xl font-medium transition-all duration-200"
              onclick="handleIosPwaClose()"
            >
              稍後再說
            </button>
            <button 
              id="primaryInstallBtn"
              class="flex-1 bg-gradient-to-r from-primary-500 to-accent-500 hover:from-primary-600 hover:to-accent-600 text-white py-3 px-6 rounded-xl font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02]"
              onclick="handlePrimaryInstallAction()"
            >
              <i class="fas fa-download mr-2"></i>
              <span id="primaryInstallText">我知道了</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 主要腳本 -->
    <script src="script.js"></script>
    
    <!-- Service Worker 註冊 -->
    </script>
  </body>

  <!-- Service Worker 註冊 -->
  <script>
    if ("serviceWorker" in navigator) {
      // 只在 HTTPS、localhost 或 127.0.0.1 環境下註冊 Service Worker
      const isSecureContext = location.protocol === 'https:' || 
                              location.hostname === 'localhost' || 
                              location.hostname === '127.0.0.1';
      
      if (isSecureContext) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("./sw.js")
          .then((registration) => {
            console.log("Service Worker 註冊成功:", registration.scope);
          })
          .catch((error) => {
              console.log("Service Worker 註冊失敗 (這在本地開發環境是正常的):", error);
          });
      });
      } else {
        console.log("Service Worker 需要 HTTPS 或 localhost 環境");
      }
    }
  </script>
</html>
